var _CI="cloudui-imageview",_data,_imgBox,_height,_index=0;$.extend({clouduiImageview:function(a,b){_height=void 0==b.height?_innerH():b.height,_data=b.data;var c='<div id="'+_CI+'">';for(c+='<div class="'+_CI+'-big-img">',c+='<div class="'+_CI+'-bl" style="top:'+(_height/2-27)+'px;"></div>',c+='<div class="'+_CI+'-br" style="top:'+(_height/2-27)+'px;"></div>',c+='<div class="'+_CI+'-img-box" style="height:'+_height+'px;"></div>',c+="</div>",c+='<div class="'+_CI+'-dst-bar">',c+='<div class="'+_CI+'-pic-num">',c+='<span class="'+_CI+'-current">1</span><span class="'+_CI+'-count">/'+_data.length+"</span>",c+="</div>",c+='<span class="'+_CI+'-description">'+$._defaultDescription()+"</span>",c+='</div><div class="'+_CI+'-thumb">',c+='<div class="'+_CI+'-tl"><div></div></div>',c+='<div class="'+_CI+'-tr"><div></div></div>',c+='<div class="'+_CI+'-thumb-img-box">',i=0;i<_data.length;i++){var d="";0==i&&(d=' class="'+_CI+'-active"'),c+='<img src="'+_data[i].thumb+'"'+d+'">'}c+="</div></div>",a.html(c).find("."+_CI+"-thumb-img-box").scrollLeft(0),_imgBox=$("#"+_CI),$._bigImg(0);var e=_imgBox.find("."+_CI+"-bl"),f=_imgBox.find("."+_CI+"-br");e.click(function(){--_index,0==_index&&e.hide(),f.is(":hidden")&&f.show(),$._changePic(1),$._changeCurrent()}),f.click(function(){_index+=1,_index==_data.length-1&&f.hide(),e.is(":hidden")&&e.show(),$._changePic(1),$._changeCurrent()});var g,h=_imgBox.find("."+_CI+"-tl"),j=_imgBox.find("."+_CI+"-thumb-img-box");h.click(function(){return g=j[0].scrollLeft,!(0>=g)&&void j.animate({scrollLeft:g-j.width()},500)});var k=_imgBox.find("."+_CI+"-tr");k.click(function(){return g=j[0].scrollLeft,!(g+j.width()>=j[0].scrollWidth)&&void j.animate({scrollLeft:g+j.width()},500)}),_imgBox.find("."+_CI+"-thumb-img-box").children("img").click(function(){return!$(this).hasClass(_CI+"-active")&&(_index=$(this).index(),$._bigImg(_index),$(this).addClass(_CI+"-active").siblings("."+_CI+"-active").removeClass(_CI+"-active"),$._thumbAutoScroll($(this),2),0<_index?e.show():e.hide(),_index<_data.length-1?f.show():f.hide(),void $._changeCurrent())})},_bigImg:function(a){var b=new Image,c=_data[a].big;_imgBox.find("."+_CI+"-img-box").html('<div class="'+_CI+'-loading">图片加载中...</div>'),b.onload=function(){var a,d=b.width,e=b.height,f="";if(e>_height){a=e/_height;var g=Math.round(d/a);f='<img src="'+c+'">'}else{var g=d;f='<img src="'+c+'" style="height:'+e+"px; margin:-"+e/2+"px 0 0 -"+d/2+'px;top:50%;left:50%;position:absolute;">'}_imgBox.find("."+_CI+"-img-box").width(g).html(f).children("img").animate({opacity:1},400)},b.src=c},_changePic:function(a){$._bigImg(_index);var b=_imgBox.find("."+_CI+"-thumb-img-box").children("img").eq(_index);b.addClass(_CI+"-active").siblings().removeClass(_CI+"-active"),$._thumbAutoScroll(b,a)},_thumbAutoScroll:function(a,b){var c=a.position().left,d=_imgBox.find("."+_CI+"-thumb-img-box"),e=d[0].scrollLeft,f=1==b?d.width()-134:134;100>c&&0<e?d.animate({scrollLeft:e-f},500):d.width()-c<100&&e+d.width()<d[0].scrollWidth&&d.animate({scrollLeft:e+f},500)},_changeCurrent:function(){_imgBox.find("."+_CI+"-current").html(_index+1),_imgBox.find("."+_CI+"-description").html($._defaultDescription())},_defaultDescription:function(){return""==_data[_index].description?"暂无描述...":_data[_index].description}});