var _CC="cloudui-citypicker",_focus=!1,_CP,_search,_tab,_dataBox,_htmlCitypicker="";_htmlCitypicker+='<div id="cloudui-citypicker">',_htmlCitypicker+='<div class="cloudui-citypicker-title"><div class="cloudui-citypicker-icon"></div>',_htmlCitypicker+="<em>选择城市 <span>(输入城市拼音首字母可快速选择)</span></em>",_htmlCitypicker+="</div>",_htmlCitypicker+='<div class="cloudui-citypicker-box">',_htmlCitypicker+='<div class="cloudui-citypicker-tab">',_htmlCitypicker+="<ul>",_htmlCitypicker+='<li class="cloudui-citypicker-active">热门</li>',_htmlCitypicker+="<li>ABC</li>",_htmlCitypicker+="<li>DEF</li>",_htmlCitypicker+="<li>GHI</li>",_htmlCitypicker+="<li>JKL</li>",_htmlCitypicker+="<li>MNO</li>",_htmlCitypicker+="<li>PQR</li>",_htmlCitypicker+="<li>STU</li>",_htmlCitypicker+="<li>VWX</li>",_htmlCitypicker+="<li>YZ</li>",_htmlCitypicker+="</ul></div>",_htmlCitypicker+='<div class="clear"></div>',_htmlCitypicker+='<div class="cloudui-citypicker-data"><div class="cloudui-citypicker-search"><div></div></div>',$.extend({clouduiCitypicker:function(a,b){var c=void 0==b.model?1:b.model;if(1==c){var d=0;a.focus(function(){$._onlyCity($(this))}).blur(function(){_focus||_CP.hide()}).keyup(function(a){var b=$(this).val(),c=a.keyCode;if(""!=b){if(c>64&&c<91||8==c||32==c){_CP.is(":hidden")&&_CP.show(),_search.is(":hidden")&&(_CP.width($(this).outerWidth()-2),_tab.hide(),_CP.children("."+_CC+"-title").children("em").html("快速选择城市"),_dataBox.hide(),_search.show());var d,e="";$.each(cpSearch,function(a,c){c.indexOf(b)!=-1&&(d=c.split("@"),e+='<div class="'+_CC+'-area">'+d[0]+"</div>")}),_search.html(e)}}else $._citypickerReset()}).keydown(function(a){if(!_search.is(":hidden")){var b=_search.children("div"),c=b.length,e=a.keyCode;38==e&&(d<0&&(d=c-1),d-=1,b.removeClass(_CC+"-active").eq(d).addClass(_CC+"-active")),40==e&&((d>c-2||0==_search.children("."+_CC+"-active").length)&&(d=-1),d+=1,b.removeClass(_CC+"-active").eq(d).addClass(_CC+"-active")),13==e&&($(this).val(_search.children("."+_CC+"-active").html()),_CP.hide(),$._citypickerReset(),_focus=!1,$._citypickerUbind())}})}else{var e,f=void 0==b.defaultProv||""==b.defaultProv?"":b.defaultProv,g=void 0==b.defaultCity||""==b.defaultCity?"":b.defaultCity,h=void 0==b.defaultArea||""==b.defaultArea?"":b.defaultArea,j=void 0==b.inputProv||""==b.inputProv?"prov":b.inputProv,k=void 0==b.inputCity||""==b.inputCity?"city":b.inputCity,l=void 0==b.inputArea||""==b.inputArea?"area":b.inputArea,m="";m+='<div id="'+_CC+'-m2-select">',m+="<span>",m+=""==f||""==g||""==h?"请选择所在地":f+" / "+g+" / "+h,m+="</span>",m+='<div class="'+_CC+'-icon"></div>',m+='<input type="hidden" name="'+j+'" value="'+f+'">',m+='<input type="hidden" name="'+k+'" value="'+g+'">',m+='<input type="hidden" name="'+l+'" value="'+h+'">',m+="</div>",a.html(m),$("#"+_CC+"-m2-select").click(function(){var a=$(this);if(0==$("#"+_CC+"-m2").length){var b=$(this).offset().left,c=$(this).offset().top+$(this).outerHeight();m="",m+='<div id="'+_CC+'-m2" style="left:'+b+"px;top:"+c+'px;">',m+='<ul class="'+_CC+'-tab">',m+='<li class="'+_CC+'-active">省份</li>',m+='<li class="'+_CC+"-disabled "+_CC+'-blr">城市</li>',m+='<li class="'+_CC+'-disabled">区县</li>',m+="</ul>",m+='<div class="'+_CC+'-prov">',$.each(cpProv,function(a,b){m+='<div class="'+_CC+'-provBox">',m+='<div class="'+_CC+'-zimu">'+a+"</div>",m+="<div><ul>",$.each(b,function(a,b){m+='<li data-id="'+a+'" data-level="1" class="'+_CC+'-data">'+b.name+"</li>"}),m+="</ul></div>",m+="</div>"}),m+="</div>",m+='<div class="'+_CC+'-city"></div>',m+='<div class="'+_CC+'-area"></div>',m+="</div>",$("body").append(m),e=$("#"+_CC+"-m2");var d=e.find("."+_CC+"-tab");e.show().attr("tabindex",0).focus().blur(function(){_focus||(e.hide(),a.children("div").removeClass(_CC+"-icon-up"))}),a.children("div").addClass(_CC+"-icon-up"),e.on("click","."+_CC+"-data",function(){var b,c,f="";if(b=$(this).attr("data-id"),c=parseInt($(this).attr("data-level")),1==c||2==c){var f="<ul>";for(i=0;i<cpCity[b].length;i++)f+='<li class="'+_CC+'-data" data-id="'+b+"-"+i+'" data-level="'+(c+1)+'">'+cpCity[b][i]+"</li>";f+="</ul>",e.children("div").eq(c-1).hide(),e.children("div").eq(c).html(f).show(),d.children("li").eq(c-1).removeClass(_CC+"-active"),d.children("li").eq(c).removeClass(_CC+"-disabled").addClass(_CC+"-active"),1==c&&d.children("li").eq(2).addClass(_CC+"-disabled")}else 3==c&&(e.hide().children("div:gt(0)").hide(),e.children("div").eq(0).show(),a.children("div").removeClass(_CC+"-icon-up"),d.children("li:gt(0)").removeClass(_CC+"-active").addClass(_CC+"-disabled"),d.children("li").eq(0).addClass(_CC+"-active"));var g=a.children("span");1==c?(f=$(this).html()+"省",g.html(f)):2!=c&&3!=c||(f=$(this).html(),f+=2==c?"市":"区",g.html(g.html()+" / "+f)),a.children("input").eq(c-1).val(f)}),d.children("li").click(function(){return!$(this).hasClass(_CC+"-disabled")&&($(this).addClass(_CC+"-active").siblings("."+_CC+"-active").removeClass(_CC+"-active"),void e.children("div").hide().eq($(this).index()).show())})}else e.is(":hidden")?(e.show().attr("tabindex",0).focus(),$(this).children("div").addClass(_CC+"-icon-up")):(e.hide(),$(this).children("div").removeClass(_CC+"-icon-up"))}).mouseover(function(){_focus=!0}).mouseout(function(){_focus=!1})}},_onlyCity:function(a){if(0==$("#"+_CC).length){var b=_htmlCitypicker;$.each(cpArea,function(a,c){b+='<div class="'+_CC+'-data-box">',$.each(c,function(a,c){b+="<div>"+c+"</div>"}),b+="</div>"}),b+='<div class="clear"></div></div></div></div>',$("body").append(b)}_CP=$("#"+_CC);var c=a.offset().left,d=a.offset().top+a.outerHeight()-1;_CP.show().css({top:d,left:c}),_CP.mouseover(function(){_focus=!0}).mouseout(function(){_focus=!1}),_search=_CP.find("."+_CC+"-search"),_tab=_CP.find("."+_CC+"-tab"),_dataBox=_CP.find("."+_CC+"-data-box"),_search.is(":hidden")&&(0==_tab.find("."+_CC+"-active").index()&&_dataBox.eq(0).show(),_tab.find("li").click(function(){$(this).addClass(_CC+"-active").siblings().removeClass(_CC+"-active"),_dataBox.hide().eq($(this).index()).show()}),_dataBox.children("div").click(function(){a.val($(this).html()),_CP.hide(),_tab.find("li").removeClass(_CC+"-active").eq(0).addClass(_CC+"-active"),_dataBox.hide().eq(0).show(),focus=!1,$._citypickerUbind()}))},_citypickerReset:function(){_search.hide(),_CP.width(396).find("."+_CC+"-tab").show(),_CP.children("."+_CC+"-title").children("em").html("选择城市 <span>(输入城市拼音首字母可快速选择)</span>"),_CP.find("."+_CC+"-data-box").eq(0).show(),_CP.find("."+_CC+"-tab").find("li").removeClass(_CC+"-active").eq(0).addClass(_CC+"-active")},_citypickerUbind:function(){_CP.unbind("mouseover").unbind("mouseout"),_tab.find("li").unbind("click"),_dataBox.children("div").unbind("click")}});